<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>å°é¸¡ç±³èŠ±çš„çŸ¥è¯†åº“</title>
    <link rel="stylesheet" href="//cdn.yesuanzao.cn/blog/atom-one-dark.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/KaTeX/0.11.1/katex.min.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css">
    <!-- æœ¬åœ°é™æ€æ–‡ä»¶æµ‹è¯• -->
    <link rel="stylesheet" href="/css/chicken.css">
<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <header>
    <div class="container">
        <div class="site-title"><a href="/">å°é¸¡ç±³èŠ±çš„çŸ¥è¯†åº“</a></div>
        <nav>
            <a class="nav-item " href="/">ä¸»é¡µ</a>
            <a class="nav-item " href="/archives">æ—¶å…‰è½´</a>
        </nav>
    </div>
</header>
    <div id="write">
    <div class="container">
        <div class="post-info">
            <ul class="tag-list">
                
                    <a class="tag-list-item" href="/tags/JavaScript/">JavaScript</a>
                
                    <a class="tag-list-item" href="/tags/Vue-js/">Vue.js</a>
                
            </ul>
        </div>
        <div class="post-content"><h1 id="ğŸ€-ä½¿ç”¨-Vuex-é›†ä¸­ç®¡ç†ç»„ä»¶çŠ¶æ€"><a href="#ğŸ€-ä½¿ç”¨-Vuex-é›†ä¸­ç®¡ç†ç»„ä»¶çŠ¶æ€" class="headerlink" title="ğŸ€ ä½¿ç”¨ Vuex é›†ä¸­ç®¡ç†ç»„ä»¶çŠ¶æ€"></a>ğŸ€ ä½¿ç”¨ Vuex é›†ä¸­ç®¡ç†ç»„ä»¶çŠ¶æ€</h1><p><a href="https://vuex.vuejs.org/zh/" target="_blank" rel="noopener">Vuex</a>æ˜¯ Vue æä¾›çš„ä¸€ä¸ªé›†ä¸­ç®¡ç†ç»„ä»¶çŠ¶æ€ï¼ˆå˜é‡ï¼‰çš„å·¥å…·ï¼Œé€šä¿—æ¥è®²ï¼Œå°±æ˜¯å°†æ‰€æœ‰ç»„ä»¶éƒ½éœ€è¦ç”¨åˆ°çš„æ•°æ®ï¼ˆçŠ¶æ€ï¼‰æ”¾ç½®åˆ°ä¸€èµ·ç»Ÿä¸€ç®¡ç†ï¼Œæ¯”å¦‚ç”¨æˆ·ç™»å½•çŠ¶æ€ã€åœ°ç†ä½ç½®ç­‰ç­‰ã€‚</p>
<pre><code class="html">&lt;script src=&quot;https://cdn.staticfile.org/vuex/3.1.3/vuex.js&quot;&gt;&lt;/script&gt;</code></pre>
<p>å°†å…¬å…±æ•°æ®æ”¾åˆ°<code>Vuex.Store()</code>å®ä¾‹å¯¹è±¡çš„<code>state</code>å±æ€§ä¸­ï¼Œå°±å¯ä»¥åœ¨ä»»ä½•ä¸€ä¸ªç»„ä»¶é€šè¿‡<code>$store.state</code>å¯¹è±¡è·å–å…¬å…±æ•°æ®äº†ï¼š</p>
<pre><code class="js">// æ³¨å†Œä¸¤ä¸ªç»„ä»¶
Vue.component(&#39;home&#39;, {
    // ä½¿ç”¨ $store è·å– Vuex å®ä¾‹
    template: &#39;&lt;h1&gt;ä¸»é¡µ {{ $store.state.msg }}&lt;/h1&gt;&#39;
})
Vue.component(&#39;about&#39;, {
    template: &#39;&lt;h1&gt;å…³äº {{ $store.state.msg }}&lt;/h1&gt;&#39;,
})

// å®ä¾‹åŒ– Vuex
const store = new Vuex.Store({
    state: { msg: &#39;è¿™æ˜¯å…¬å…±çŠ¶æ€å•¦&#39; }
})

const vue = new Vue({
    el: &#39;#app&#39;,
    store // æ³¨å†Œ Vuex å®ä¾‹
})</code></pre>
<h2 id="mutations"><a href="#mutations" class="headerlink" title="mutations"></a>mutations</h2><p>æ³¨æ„ï¼Œä¸è¦åœ¨ç»„ä»¶ä¸­ä½¿ç”¨<code>$store.state</code>ä¿®æ”¹çŠ¶æ€ï¼Œè¿™æ ·ä¼šå¯¼è‡´ Vue æ— æ³•è·Ÿè¸ªçŠ¶æ€å˜åŒ–ã€‚å®˜æ–¹å»ºè®®åœ¨<code>Vuex.Store()</code>å®ä¾‹çš„<code>mutations</code>å±æ€§ä¸­å®šä¹‰ä¿®æ”¹çŠ¶æ€çš„æ–¹æ³•ï¼Œè€Œç»„ä»¶ä¸­åªéœ€è¦è°ƒç”¨è¿™äº›æ–¹æ³•å³å¯ã€‚è¿™äº›æ–¹æ³•é»˜è®¤ä¼šä¼ å…¥ä¸€ä¸ª<code>state</code>å‚æ•°ï¼Œé€šè¿‡å®ƒå¯ä»¥ç›´æ¥è·å–<code>state</code>ä¸­çš„å±æ€§ã€‚</p>
<p>åœ¨ç»„ä»¶ä¸­éœ€è¦é€šè¿‡<code>$store.commit()</code>æ–¹æ³•è°ƒç”¨ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°ä¸º<code>mutations</code>ä¸­å®šä¹‰çš„æ–¹æ³•åï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºæœ¬èº«éœ€è¦ä¼ é€’çš„å‚æ•°ï¼Œ<strong>å¦‚æœéœ€è¦ä¼ é€’å¤šä¸ªå‚æ•°ï¼Œåˆ™å¯ä»¥é€šè¿‡å¯¹è±¡æ¥ä¼ é€’</strong>ï¼Œå› æ­¤å®ƒä¹Ÿè¢«ç§°ä¸ºè½½è·ï¼ˆPayloadï¼‰ã€‚</p>
<pre><code class="js">Vue.component(&#39;home&#39;, {
    template: &#39;&lt;h1 @click=&quot;homeClick&quot;&gt;{{ $store.state.msg }}&lt;/h1&gt;&#39;,
    methods: {
        // è°ƒç”¨ mutations æ–¹æ³•
        homeClick() { this.$store.commit(&#39;change&#39;, { changedMsg: &#39;ä¿®æ”¹çŠ¶æ€ï¼&#39; }) }
    }
})

const store = new Vuex.Store({
    state: { msg: &#39;è¿™æ˜¯å…¬å…±çŠ¶æ€å•¦&#39; },
    mutations: {
        // ç”¨æ¥ä¿®æ”¹ state
        change(state, payload) { state.msg = payload.changedMsg }
    }
})</code></pre>
<p><code>mutations</code>çš„æ–¹æ³•åç§°ä¹Ÿç§°ä¸ºã€Œç±»å‹ã€ï¼Œå®é™…å¼€å‘ä¸­ï¼Œå»ºè®®å°†ç±»å‹ç»Ÿä¸€å®šä¹‰ä¸ºå¸¸é‡ï¼Œä»¥æ–¹ä¾¿ç®¡ç†ã€‚ä¸ºæ­¤<code>mutations</code>ä¸­çš„æ–¹æ³•åå¯ä»¥ç”¨ç‰¹æ®Šçš„æ–¹æ‹¬å·è¯­æ³•æ¥å®šä¹‰ï¼š</p>
<pre><code class="js">// å°†ç±»å‹ç»Ÿä¸€å®šä¹‰ä¸ºå¸¸é‡
const CHANGE = &#39;change&#39;

Vue.component(&#39;home&#39;, {
    methods: {
        // è°ƒç”¨æ—¶ä¼ å…¥å¸¸é‡å³å¯
        homeClick() { this.$store.commit(CHANGE) }
    }
})

const store = new Vuex.Store({
    state: { msg: &#39;è¿™æ˜¯å…¬å…±çŠ¶æ€å•¦&#39; },
    mutations: {
        // ä»¥æ–¹æ‹¬å·çš„ç‰¹æ®Šè¯­æ³•æ¥ä½¿ç”¨å¸¸é‡
        [CHANGE](state) {}
    }
})</code></pre>
<h2 id="getters"><a href="#getters" class="headerlink" title="getters"></a>getters</h2><p><code>getters</code>ç±»ä¼¼äºä¹‹å‰çš„è®¡ç®—å±æ€§ï¼Œé€šè¿‡å‡½æ•°çš„è¿”å›å€¼å¯¹çŠ¶æ€ä½œå‡ºè¿›ä¸€æ­¥å¤„ç†ã€‚å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°åŒæ ·ä¸º<code>state</code>ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸º<code>getters</code>æœ¬èº«ï¼Œå¯ä»¥ç”¨æ¥è·å–å…¶å®ƒ<code>getters</code>ã€‚</p>
<p>åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œä½¿ç”¨<code>getters</code>è¿‡æ»¤äº†ä»·æ ¼è¾ƒè´µçš„ä¹¦ç±ï¼Œå¹¶è·å–äº†è¿™äº›ä¹¦ç±çš„æ•°é‡ï¼Œç„¶ååœ¨ç»„ä»¶ä¸­ç›´æ¥è°ƒç”¨<code>getters</code>è·å–è¿‡æ»¤åçš„ç»“æœï¼š</p>
<pre><code class="js">Vue.component(&#39;home&#39;, {
    // è°ƒç”¨ getters
    template: &#39;&lt;h1&gt;{{ $store.getters.expensiveBooks }}&lt;/h1&gt;&#39;,
})

const store = new Vuex.Store({
    state: {
        books: [
            { id: 1000, name: &#39;åŒ—æ¬§ç¥è¯&#39;, price: 21 },
            { id: 1001, name: &#39;JOJOçš„å¥‡å¦™å†’é™©&#39;, price: 199 },
            { id: 1002, name: &#39;ä»é›¶å¼€å§‹çš„å¼‚ä¸–ç•Œç”Ÿæ´»&#39;, price: 233 }
        ]
    },
    getters: {
        // è·å–è¾ƒè´µçš„ä¹¦ç±
        expensiveBooks(state) {
            return state.books.filter(el =&gt; el.price &gt; 100)
        },
        // é€šè¿‡ expensiveBooks è·å–è¾ƒè´µä¹¦ç±çš„æ•°é‡
        expensiveBooksLength(state, getters) {
            return getters.expensiveBooks.length
        }
    }
})</code></pre>
<p>ç”±äºå®ƒçš„ç¬¬äºŒä¸ªå‚æ•°ä¸º<code>getters</code>ï¼Œå› æ­¤ä¸èƒ½åƒ<code>mutations</code>ä¸€æ ·æ¥æ”¶å‚æ•°ã€‚å› æ­¤ï¼Œå¦‚æœå¸Œæœ›æ•°æ®æ˜¯åœ¨è°ƒç”¨æ—¶ä¼ å…¥çš„ï¼Œåˆ™éœ€è¦å°†<code>getters</code>è¿”å›ä¸€ä¸ªå‡½æ•°ã€‚</p>
<pre><code class="js">Vue.component(&#39;home&#39;, {
    template: &#39;&lt;h1&gt;{{ $store.getters.expensiveBooks(200) }}&lt;/h1&gt;&#39;,
})

const store = new Vuex.Store({
    getters: {
        expensiveBooks(state) {
            return function(price) {
                return state.books.filter(el =&gt; el.price &gt; price)
            }
        }
    }
})</code></pre>
<h2 id="actions"><a href="#actions" class="headerlink" title="actions"></a>actions</h2><p>å¦‚æœ Vuex ä¸­æœ‰å¼‚æ­¥æ“ä½œï¼Œé‚£ä¹ˆéœ€è¦å°†å…¶æ”¾åˆ°<code>actions</code>å±æ€§ä¸­ï¼Œé€šè¿‡å®ƒå†æ¥è°ƒç”¨<code>mutations</code>ï¼Œä»è€Œæ”¹å˜<code>state</code>çŠ¶æ€ã€‚è€Œç»„ä»¶ä¸­ä¹Ÿéœ€è¦ä½¿ç”¨<code>$store.dispatch()</code>æ¥è°ƒç”¨<code>actions</code>ï¼Œä¸ä½¿ç”¨<code>$store.commit()</code>è°ƒç”¨<code>mutations</code>ç±»ä¼¼ã€‚</p>
<p>ä¸<code>$store.commit()</code>ä¸åŒçš„ä¸€ç‚¹æ˜¯ï¼Œå®ƒä¸ä¼šæ¥æ”¶<code>state</code>ä½œä¸ºå‚æ•°ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯çš„<code>context</code>å¯¹è±¡ã€‚å®ƒç±»ä¼¼äº<code>$store</code>ï¼Œå¯ä»¥è°ƒç”¨å…¶ä¸­çš„å±æ€§å’Œå®ä¾‹æ–¹æ³•ï¼Œä½†æ˜¯åˆç•¥æœ‰ä¸åŒï¼ˆè§ä¸‹æ–‡ï¼‰ã€‚</p>
<pre><code class="js">Vue.component(&#39;home&#39;, {
    template: &#39;&lt;div&gt;&lt;button @click=&quot;btnClick&quot;&gt;1 ç§’åæ”¹å˜çŠ¶æ€&lt;/button&gt; {{ $store.state.msg }} &lt;/div&gt;&#39;,
    methods: {
        btnClick() {
            // è°ƒç”¨ actions æ–¹æ³•ï¼Œä¹Ÿæœ‰ payload å‚æ•°
            this.$store.dispatch(&#39;actionChange&#39;, {})
        }
    }
})

const store = new Vuex.Store({
    state: { msg: &#39;è¿™æ˜¯å…¬å…±çŠ¶æ€å•¦&#39; },
    mutations: {
        // é€šè¿‡ mutations ä¿®æ”¹çŠ¶æ€
        mutationChange(state) {
            state.msg = &#39;æ”¹å˜çŠ¶æ€ï¼&#39;
        }
    },
    actions: {
        actionChange(context, payload) {
            // å¼‚æ­¥ä»»åŠ¡
            setTimeout(() =&gt; {
                // é€šè¿‡ context è°ƒç”¨ mutations
                context.commit(&#39;mutationChange&#39;)
            }, 1000)
        }
    }
})</code></pre>
<h2 id="modules"><a href="#modules" class="headerlink" title="modules"></a>modules</h2><p>Vuex ä½¿ç”¨äº†å•ä¸€çŠ¶æ€æ ‘ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>Vuex.Store()</code>å®ä¾‹åªèƒ½æœ‰ä¸€ä¸ªï¼Œå› æ­¤æ‰€æœ‰çŠ¶æ€éƒ½ä¼šä¿å­˜åˆ°è¿™ä¸€ä¸ªå¯¹è±¡ä¸­ã€‚ä½†æ˜¯ï¼Œå½“åº”ç”¨å˜å¾—éå¸¸å¤æ‚æ—¶ï¼Œ<code>store</code>å¯¹è±¡å°±æœ‰å¯èƒ½å˜å¾—ç›¸å½“è‡ƒè‚¿ã€‚</p>
<p>ä¸ºäº†è§£å†³ä»¥ä¸Šé—®é¢˜ï¼ŒVuex å…è®¸åœ¨<code>store</code>å¯¹è±¡ä¸­ç»§ç»­å®šä¹‰æ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—éƒ½å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„<code>state</code>ã€<code>mutations</code>ã€<code>actions</code>ã€<code>getters</code>ï¼Œç”šè‡³æ˜¯åµŒå¥—å­æ¨¡å—ï¼ˆè™½ç„¶ä¸å»ºè®®è¿™ä¹ˆç”¨ï¼Œè¿™ä¼šä½¿å¾—ä»£ç éå¸¸éš¾ä»¥ç†è§£ï¼‰ï¼š</p>
<pre><code class="js">Vue.component(&#39;home&#39;, {
    // é€šè¿‡ $store.state.æ¨¡å—å è·å–æ¨¡å—çš„ state
    template: &#39;&lt;h1&gt;ä¸»é¡µ {{ $store.state.HomeModule.msg }} &lt;/h1&gt;&#39;,
    methods: {
        // mutationsã€gettersã€actions çš„è°ƒç”¨æ–¹å¼ä¸ä¹‹å‰ä¸€æ ·ï¼ŒVuex ä¼šå…ˆåœ¨æ ¹å¯¹è±¡ä¸­å¯»æ‰¾ï¼Œæ²¡æœ‰åˆ™ä¼šå»æ¨¡å—ä¸‹å¯»æ‰¾
        change() { $store.commit(&#39;change&#39;) }
    }
})

const store = new Vuex.Store({
    // å®šä¹‰æ¨¡å—
    modules: {
        HomeModule: {
            state: { msg: &#39;è¿™æ˜¯ä¸»é¡µçš„å…¬å…±çŠ¶æ€å•¦&#39; },
            mutations: {
                mutationChange(state) {} 
            },
            // æ¨¡å—ä¸­ getters ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥è·å–æ ¹çŠ¶æ€ä¸‹çš„ state
            getters: {
                getterMsg(state, getters, rootState) {}
            }
            // æ¨¡å—ä¸­ actions çš„ context åªåŒ…å«è¯¥æ¨¡å—ä¸­çš„çŠ¶æ€ï¼Œè¿™å°±æ˜¯ context ä¸ $store çš„åŒºåˆ«
            actions: {
                actionChange(context) {
                    context.getters // è·å–æ ¹çŠ¶æ€ä¸­çš„ getters
                }
            }
        }
    }
})</code></pre>
</div>
    </div>
</div>

<div class="toc"></div>
    <footer>
    <p>Â© 2020</p>
    <p>Theme chicken by å°é¸¡ç±³èŠ±, Powered by Hexo</p>
</footer>
    <a class="back-to-top" href="javascript:;"></a>

    <script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script>
    <script defer src="https://cdn.staticfile.org/KaTeX/0.11.1/katex.min.js"></script>
    <script defer src="https://cdn.staticfile.org/KaTeX/0.11.1/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, { strict: false, delimiters: [{left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}] });"></script>
    <script src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js"></script>
    <script src="https://cdn.staticfile.org/highlight.js/9.18.1/highlight.min.js"></script>

    <script>
        // ä¸ºæ ‡ç­¾è¿½åŠ å­—ä½“å›¾æ ‡
        $('.tag-list-item').prepend('<i class="fas fa-tag"></i>')

        // å›åˆ°é¡¶éƒ¨çš„çŒ«
        $('.back-to-top').click(function () {
            $('html, body').animate({
                scrollTop: 0
            }, 500)
        })

        // ç›‘å¬ å›åˆ°é¡¶éƒ¨çš„çŒ« æ˜¯å¦æ˜¾ç¤º
        $(document).scroll(function () {
            if ($(document).scrollTop() > 50) {
                $('.back-to-top').addClass('show')
            } else {
                $('.back-to-top').removeClass('show')
            }
        })

        // åœ¨è¡¨æ ¼å¤–åŒ…è£¹ä¸€å±‚ï¼Œç”¨æ¥ç”Ÿæˆæ»šåŠ¨æ¡
        $('.post-content > table').wrap('<div class="table-container"></div>')

        // Tocbot å®ä¾‹åŒ–ï¼Œç”¨æ¥å¿«é€Ÿç”Ÿæˆæ–‡æ¡£ç›®å½•
        tocbot.init({
            tocSelector: '.toc', // æ¸²æŸ“ç›®å½•çš„å®¹å™¨
            contentSelector: '.post-content', // æ ‡é¢˜æ‰€åœ¨çš„å®¹å™¨
            headingSelector: 'h2, h3', // è¦æ¸²æŸ“çš„ç›®å½•å±‚çº§,
            headingsOffset: -50, // å¾®è°ƒç›®å½•é«˜äº®çš„æ˜¾ç¤ºä½ç½®ï¼ˆåç§»é‡ï¼‰ï¼Œé˜²æ­¢ç‚¹å‡»çš„é“¾æ¥å’Œé«˜äº®çš„é“¾æ¥ä¸ä¸€è‡´
        })

        // åˆå§‹åŒ–ä»£ç é«˜äº® highlight.js
        hljs.initHighlightingOnLoad()

        // è‡ªåŠ¨åŠ è½½ waifu
        try {
            $("<link>").attr({ href: "//cdn.yesuanzao.cn/blog/live2d/waifu.min.css", rel: "stylesheet", type: "text/css" }).appendTo('head');
            $('body').append('<div class="waifu"><div class="waifu-tips"></div><canvas id="live2d" class="live2d"></canvas><div class="waifu-tool"><span class="fui-home"></span> <span class="fui-chat"></span> <span class="fui-eye"></span> <span class="fui-user"></span> <span class="fui-photo"></span> <span class="fui-info-circle"></span> <span class="fui-cross"></span></div></div>');
            $.ajax({ url: '//cdn.yesuanzao.cn/blog/live2d/waifu-tips.js', dataType: "script", cache: true, async: false });
            $.ajax({ url: '//cdn.yesuanzao.cn/blog/live2d/live2d.min.js', dataType: "script", cache: true, async: false, success: function() {
                initModel('//cdn.yesuanzao.cn/blog/live2d/waifu-tips.json');
            } });
        } catch (err) { console.log(err) }
    </script>
    <!-- 
        æ·»åŠ æ§åˆ¶å°ï¼Œæµ‹è¯•ç§»åŠ¨ç«¯
        <script src="http://cdn.jsdelivr.net/npm/eruda"></script>
        <script>eruda.init();</script>
    -->
</body>

</html>