<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>è¿™æ˜¯ä¸€ä¸ªç¥å¥‡çš„ä¸»é¢˜</title>
    <link rel="stylesheet" href="//cdn.yesuanzao.cn/blog/chicken.css">
    <link rel="stylesheet" href="//cdn.yesuanzao.cn/blog/atom-one-dark.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/KaTeX/0.11.1/katex.min.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css">
    <!-- æœ¬åœ°é™æ€æ–‡ä»¶æµ‹è¯• -->
    <!-- <link rel="stylesheet" href="/css/chicken.css"> -->
<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <header>
    <div class="container">
        <div class="site-title"><a href="/">å°é¸¡ç±³èŠ±çš„çŸ¥è¯†åº“</a></div>
        <nav>
            <a class="nav-item " href="/">ä¸»é¡µ</a>
            <a class="nav-item " href="/archives">æ—¶å…‰è½´</a>
        </nav>
    </div>
</header>
    <div id="write">
    <div class="container">
        <div class="post-info">
            <ul class="tag-list">
                
                    <a class="tag-list-item" href="/tags/Node-js/">Node.js</a>
                
            </ul>
        </div>
        <div class="post-content"><h1 id="å¤§å‰ç«¯æ”¯çº¿ç¬”è®°ä¹‹06-ğŸ˜¨-Node-js-åŸç”Ÿæ„å»ºç½‘ç»œæœåŠ¡"><a href="#å¤§å‰ç«¯æ”¯çº¿ç¬”è®°ä¹‹06-ğŸ˜¨-Node-js-åŸç”Ÿæ„å»ºç½‘ç»œæœåŠ¡" class="headerlink" title="å¤§å‰ç«¯æ”¯çº¿ç¬”è®°ä¹‹06 ğŸ˜¨ Node.js åŸç”Ÿæ„å»ºç½‘ç»œæœåŠ¡"></a>å¤§å‰ç«¯æ”¯çº¿ç¬”è®°ä¹‹06 ğŸ˜¨ Node.js åŸç”Ÿæ„å»ºç½‘ç»œæœåŠ¡</h1><blockquote>
<p>æ–½å·¥ä¸­ï¼Œä¿®æ”¹æ—¶é—´</p>
</blockquote>
<h3 id="åˆ›å»ºæœåŠ¡å™¨"><a href="#åˆ›å»ºæœåŠ¡å™¨" class="headerlink" title="åˆ›å»ºæœåŠ¡å™¨"></a>åˆ›å»ºæœåŠ¡å™¨</h3><p>ä¸‹é¢çš„ä»£ç å¯ä»¥åˆ›å»ºä¸€ä¸ªæœ€ç®€å•çš„æœåŠ¡å™¨ï¼š</p>
<pre><code class="js">const http = require(&#39;http&#39;) // å¼•å…¥æ¨¡å—
const app = http.createServer() // åˆ›å»ºæœåŠ¡å™¨
app.listen(3000, function() { // ç›‘å¬ç«¯å£
    console.log(&#39;æœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼Œæ­£åœ¨ç›‘å¬ 3000 ç«¯å£&#39;)
})</code></pre>
<h3 id="æ¥æ”¶è¯·æ±‚"><a href="#æ¥æ”¶è¯·æ±‚" class="headerlink" title="æ¥æ”¶è¯·æ±‚"></a>æ¥æ”¶è¯·æ±‚</h3><p>å½“æœåŠ¡å™¨æ¥æ”¶çš„è¯·æ±‚æ—¶ä¼šè§¦å‘æœåŠ¡å™¨å¯¹è±¡çš„<code>request</code>äº‹ä»¶ï¼ŒNode.js ä¹Ÿæ˜¯é€šè¿‡<code>on()</code>æ–¹æ³•ç›‘å¬äº‹ä»¶ï¼Œè¯¥æ–¹æ³•å®šä¹‰åœ¨<code>Events</code>æ¨¡å—ä¸­ã€‚</p>
<pre><code class="js">app.on(&#39;request&#39;, (req, res) =&gt; { // req å’Œ res åˆ†åˆ«ä¸ºè¯·æ±‚å¯¹è±¡ä¸å“åº”å¯¹è±¡
  // å¤„ç†è¯·æ±‚
})</code></pre>
<p>è¯·æ±‚è¡Œå’Œè¯·æ±‚å¤´å¯ä»¥é€šè¿‡è¯·æ±‚å¯¹è±¡è·å–ï¼š</p>
<pre><code class="js">app.on(&#39;request&#39;, (req, res) =&gt; {
    req.method  // è¯·æ±‚æ–¹å¼ï¼Œå€¼ä¸º &#39;GET&#39; æˆ– &#39;POST&#39;
    req.url     // è¯·æ±‚ URL çš„ path éƒ¨åˆ†ï¼Œå¦‚ /index?id=233ï¼Œä½¿ç”¨ URL æ¨¡å—å¯ä»¥æå–å‡º GET æ–¹å¼ä¼ é€’çš„å‚æ•°
    req.headers // è¯·æ±‚å¤´çš„ä¿¡æ¯ï¼Œä½¿ç”¨æ–¹æ‹¬å·ä¼ å…¥é”®åå¯ä»¥è·å–å¯¹åº”çš„å€¼
})</code></pre>
<p>è¯·æ±‚ä½“ï¼ˆæ¯”å¦‚<code>POST</code>æ–¹å¼ä¼ é€’çš„å‚æ•°ï¼‰çš„è·å–æ¯”è¾ƒéº»çƒ¦ï¼Œå› ä¸ºå®ƒæ˜¯é€šè¿‡æµçš„æ–¹å¼ä¼ é€’çš„ã€‚</p>
<p>å½“æµæ¥æ”¶åˆ°æ–°çš„ç¼“å­˜<code>Buffer</code>æ—¶ä¼šè§¦å‘<code>data</code>äº‹ä»¶ï¼Œä½†æ˜¯è¿™æ—¶çš„å†…å®¹å¯èƒ½å¹¶ä¸å®Œå…¨ï¼Œå½“æµæ¥æ”¶åˆ°å…¨éƒ¨å†…å®¹æ—¶ï¼Œä¼šè§¦å‘<code>end</code>äº‹ä»¶ã€‚å› æ­¤æœ€å¥½æ˜¯åœ¨<code>data</code>äº‹ä»¶ä¸­å°†ç¼“å­˜æ•°ç»„æ‹¼æ¥èµ·æ¥ï¼Œç„¶ååœ¨<code>end</code>äº‹ä»¶ä¸­è¾“å‡ºï¼š</p>
<pre><code class="js">app.on(&#39;request&#39;, (req, res) =&gt; {
    let reqBody = &#39;&#39; // å£°æ˜ä¸€ä¸ªå˜é‡ï¼Œè¡¨ç¤ºè¯·æ±‚ä½“æ•°æ®
    req.on(&#39;data&#39;, temp =&gt; reqBody += temp) // æ‹¼æ¥è·å–çš„ç¼“å†²
    req.on(&#39;end&#39;, () =&gt; reqBody) // ä¼ è¾“å®Œæ¯•åè·å–è¯·æ±‚ä½“
})</code></pre>
<h3 id="è¿”å›å“åº”"><a href="#è¿”å›å“åº”" class="headerlink" title="è¿”å›å“åº”"></a>è¿”å›å“åº”</h3><p>å½“è¯·æ±‚å¤„ç†å®Œæ¯•åï¼Œåº”å½“ç»™å®¢æˆ·ç«¯è¿”å›å“åº”ï¼Œå¦åˆ™å®¢æˆ·ç«¯ä¼šä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ï¼ˆæµè§ˆå™¨è½¬åœˆï¼‰ã€‚</p>
<p>ä¸è¿‡åœ¨æ­¤ä¹‹å‰ï¼Œå¯ä»¥å…ˆé€šè¿‡<code>writeHead()</code>æ–¹æ³•è®¾ç½®ä¸€ä¸‹å“åº”è¡Œå’Œå“åº”å¤´ã€‚å› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å“åº”çš„æ•°æ®ä¸º UTF-8 ç¼–ç ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰åœ¨å“åº”å¤´ä¸­å£°æ˜ï¼Œæˆ–è€…åœ¨ HTML æ–‡ä»¶ä¸­ä½¿ç”¨<code>&lt;meta charset=&quot;UTF-8&quot;&gt;</code>å‘ŠçŸ¥æµè§ˆå™¨çš„è¯ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šé‡‡ç”¨å½“å‰æ“ä½œç³»ç»Ÿçš„ç¼–ç å³ GBK æ¥è§£æï¼Œä¼šå‡ºç°ä¹±ç é—®é¢˜ã€‚</p>
<blockquote>
<ul>
<li>å‚æ•°â‘ ï¼šHTTP çŠ¶æ€ç </li>
<li>å‚æ•°â‘¡ï¼šå¯é€‰ï¼Œå“åº”å¤´ä¿¡æ¯çš„é”®å€¼å¯¹</li>
<li>è¿”å›å€¼ï¼šè°ƒç”¨å®ƒçš„å“åº”å¯¹è±¡ï¼Œå¯ä»¥é“¾å¼ç¼–ç¨‹</li>
</ul>
</blockquote>
<pre><code class="js">app.on(&#39;request&#39;, (req, res) =&gt; {
    res.writeHead(200, { // ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå“åº”è¡Œçš„çŠ¶æ€ç ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå“åº”å¤´çš„é”®å€¼å¯¹
        &#39;content-type&#39;: &#39;text/html;charset=utf8&#39; // è®¾ç½®å“åº”å¤´ä¸­çš„èµ„æºç±»å‹å’Œç¼–ç 
    })
})</code></pre>
<p>æœ€åï¼Œé€šè¿‡<code>end()</code>æ–¹æ³•ä¸ºå®¢æˆ·ç«¯è¿”å›å“åº”ï¼ŒåŒæ—¶è®¾ç½®å“åº”ä½“ã€‚</p>
<blockquote>
<ul>
<li>å‚æ•°â‘ ï¼šå­—ç¬¦ä¸²ç±»å‹çš„å“åº”ä½“ï¼Œå¦‚æœæ˜¯å¤æ‚æ•°æ®ä¸è¦å¿˜è®°è½¬æ¢æˆ JSON</li>
</ul>
</blockquote>
<pre><code class="js">app.on(&#39;request&#39;, (req, res) =&gt; {
    res.end(&#39;&lt;h1&gt;hello&lt;/h1&gt;&#39;) // å“åº”å†…å®¹
})</code></pre>
<h3 id="é¡µé¢è·¯ç”±"><a href="#é¡µé¢è·¯ç”±" class="headerlink" title="é¡µé¢è·¯ç”±"></a>é¡µé¢è·¯ç”±</h3><p>ç„¶è€Œæ­¤æ—¶æ— è®ºç”¨æˆ·è®¿é—®ä»»ä½•åœ°å€ï¼ŒæœåŠ¡å™¨éƒ½åªèƒ½å“åº”ç›¸åŒçš„å†…å®¹ã€‚å¦‚æœå¸Œæœ›å®ç°ç”¨æˆ·è¯·æ±‚ä¸åŒè·¯å¾„ï¼Œè¿”å›å¯¹åº”å†…å®¹ï¼Œé¦–å…ˆè¦æ ¹æ®è¯·æ±‚å¯¹è±¡çš„<code>url</code>è§£æå‡º<code>pathname</code>éƒ¨åˆ†ï¼ˆä½¿ç”¨ url æ¨¡å—ï¼‰ï¼Œç„¶åæ ¹æ®ä¸åŒçš„<code>pathname</code>è¿”å›å¯¹åº”çš„å†…å®¹ã€‚</p>
<p>ä¸‹é¢çš„ä»£ç å®ç°äº†ç®€å•çš„é¡µé¢è·¯ç”±ï¼Œå¯ä»¥çœ‹å‡ºï¼Œ<strong>ç”¨æˆ·è¯·æ±‚çš„è·¯å¾„ä¸å®é™…è¿”å›çš„å†…å®¹æ˜¯å®Œå…¨æ²¡æœ‰å…³ç³»çš„</strong>ï¼Œå…¨å‡­æœåŠ¡å™¨å¦‚ä½•å¤„ç†ã€‚</p>
<pre><code class="js">const url = require(&#39;url&#39;)

app.on(&#39;request&#39;, (req, res) =&gt; {
    // req.url æ˜¯åŒ…å«å‚æ•°çš„ï¼Œå¦‚ /index?id=233ï¼Œä½¿ç”¨ parse() å¯ä»¥æå–å‡º /index éƒ¨åˆ†
    let pathname = url.parse(req.url).pathname

     // æ ¹æ®è¯·æ±‚è·¯å¾„è¿”å›å¯¹åº”å†…å®¹
    switch (pathname) {
        case &#39;/&#39;:
        case &#39;/index&#39;:
            res.end(&#39;æ¬¢è¿æ¥åˆ°ä¸»é¡µ&#39;)
            break
        case &#39;/list&#39;:
            res.end(&#39;æ¬¢è¿æ¥åˆ°åˆ—è¡¨é¡µ&#39;)
            break
        default:
            res.end(&#39;æ‚¨è®¿é—®çš„é¡µé¢ä¸å­˜åœ¨&#39;)
            break
    }
})</code></pre>
<blockquote>
<p><em>å‚è€ƒèµ„æ–™</em></p>
<ul>
<li>ã€Šæ·±å…¥æµ…å‡º Node.jsã€‹</li>
</ul>
</blockquote>
</div>
    </div>
</div>

<div class="toc"></div>
    <footer>
    <p>Â© 2020</p>
    <p>Theme chicken by å°é¸¡ç±³èŠ±, Powered by Hexo</p>
</footer>
    <a class="back-to-top" href="javascript:;"></a>

    <script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script>
    <script defer src="https://cdn.staticfile.org/KaTeX/0.11.1/katex.min.js"></script>
    <script defer src="https://cdn.staticfile.org/KaTeX/0.11.1/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, { strict: false, delimiters: [{left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}] });"></script>
    <script src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js"></script>
    <script src="https://cdn.staticfile.org/highlight.js/9.18.1/highlight.min.js"></script>

    <script>
        // ä¸ºæ ‡ç­¾è¿½åŠ å­—ä½“å›¾æ ‡
        $('.tag-list-item').prepend('<i class="fas fa-tag"></i>')

        // å›åˆ°é¡¶éƒ¨çš„çŒ«
        $('.back-to-top').click(function () {
            $('html, body').animate({
                scrollTop: 0
            }, 500)
        })

        // ç›‘å¬ å›åˆ°é¡¶éƒ¨çš„çŒ« æ˜¯å¦æ˜¾ç¤º
        $(document).scroll(function () {
            if ($(document).scrollTop() > 50) {
                $('.back-to-top').addClass('show')
            } else {
                $('.back-to-top').removeClass('show')
            }
        })

        // åœ¨è¡¨æ ¼å¤–åŒ…è£¹ä¸€å±‚ï¼Œç”¨æ¥ç”Ÿæˆæ»šåŠ¨æ¡
        $('.post-content > table').wrap('<div class="table-container"></div>')

        // Tocbot å®ä¾‹åŒ–ï¼Œç”¨æ¥å¿«é€Ÿç”Ÿæˆæ–‡æ¡£ç›®å½•
        tocbot.init({
            tocSelector: '.toc', // æ¸²æŸ“ç›®å½•çš„å®¹å™¨
            contentSelector: '.post-content', // æ ‡é¢˜æ‰€åœ¨çš„å®¹å™¨
            headingSelector: 'h2, h3', // è¦æ¸²æŸ“çš„ç›®å½•å±‚çº§,
            headingsOffset: -50, // å¾®è°ƒç›®å½•é«˜äº®çš„æ˜¾ç¤ºä½ç½®ï¼ˆåç§»é‡ï¼‰ï¼Œé˜²æ­¢ç‚¹å‡»çš„é“¾æ¥å’Œé«˜äº®çš„é“¾æ¥ä¸ä¸€è‡´
        })

        // åˆå§‹åŒ–ä»£ç é«˜äº® highlight.js
        hljs.initHighlightingOnLoad()

        // è‡ªåŠ¨åŠ è½½ waifu
        try {
            $("<link>").attr({ href: "//cdn.yesuanzao.cn/blog/live2d/waifu.min.css", rel: "stylesheet", type: "text/css" }).appendTo('head');
            $('body').append('<div class="waifu"><div class="waifu-tips"></div><canvas id="live2d" class="live2d"></canvas><div class="waifu-tool"><span class="fui-home"></span> <span class="fui-chat"></span> <span class="fui-eye"></span> <span class="fui-user"></span> <span class="fui-photo"></span> <span class="fui-info-circle"></span> <span class="fui-cross"></span></div></div>');
            $.ajax({ url: '//cdn.yesuanzao.cn/blog/live2d/waifu-tips.js', dataType: "script", cache: true, async: false });
            $.ajax({ url: '//cdn.yesuanzao.cn/blog/live2d/live2d.min.js', dataType: "script", cache: true, async: false, success: function() {
                initModel('//cdn.yesuanzao.cn/blog/live2d/waifu-tips.json');
            } });
        } catch (err) { console.log(err) }
    </script>
    <!-- 
        æ·»åŠ æ§åˆ¶å°ï¼Œæµ‹è¯•ç§»åŠ¨ç«¯
        <script src="http://cdn.jsdelivr.net/npm/eruda"></script>
        <script>eruda.init();</script>
    -->
</body>

</html>